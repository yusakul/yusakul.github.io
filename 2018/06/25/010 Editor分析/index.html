<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="010 Editor v8.0.1_x32分析以及注册机制作"><meta name="keywords" content="逆向工程"><meta name="author" content="梁言,undefined"><meta name="copyright" content="梁言"><title>010 Editor v8.0.1_x32分析以及注册机制作 | Hexo</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css?version=1.5.5"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#环境以及工具"><span class="toc-number">1.</span> <span class="toc-text">环境以及工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第一步-找到判断注册结果的关键跳转和关键函数"><span class="toc-number">2.</span> <span class="toc-text">第一步 找到判断注册结果的关键跳转和关键函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第二步-分析关键函数"><span class="toc-number">3.</span> <span class="toc-text">第二步 分析关键函数</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">梁言</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">5</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div class="no-bg" id="top-container" style="background-image: url(true)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Hexo</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">010 Editor v8.0.1_x32分析以及注册机制作</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2018-06-25</time></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h3 id="环境以及工具"><a href="#环境以及工具" class="headerlink" title="环境以及工具"></a>环境以及工具</h3><blockquote>
<p>Window7_x32</p>
<p>010 Editor v8.0.1_x32</p>
<p>OD</p>
<p>VS2017</p>
</blockquote>
<h3 id="第一步-找到判断注册结果的关键跳转和关键函数"><a href="#第一步-找到判断注册结果的关键跳转和关键函数" class="headerlink" title="第一步 找到判断注册结果的关键跳转和关键函数"></a>第一步 找到判断注册结果的关键跳转和关键函数</h3><blockquote>
<p>使用OD打开010editor，进入到注册界面，先尝试输入随意的ID和Key，获取弹出的提示信息字符串</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/18287022.jpg" alt=""></p>
<blockquote>
<p>尝试在OD中搜索如下字符 “Invalid name or password.”，搜索结果如下</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/82561798.jpg" alt=""></p>
<blockquote>
<p>发现存在大量提示信息，我们在其中找到注册成功的提示信息，（上图红框：感谢购买010editor），双击查看反汇编窗口，见下图。</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/57856353.jpg" alt=""></p>
<blockquote>
<p>往上查看判断注册成功的关键跳转</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/70209865.jpg" alt=""></p>
<blockquote>
<p>我们发现地址为00DD5926处跳转JNZ 010Edito.00DD5A58应该为关键跳转，下方可以找到输出字符串”Password accepted. This ….”， 而其跳转地址处汇编代码为输出”Password accepted….”</p>
<p>（010editor使用<em>QT</em>界面库编写 ，我们可以猜测出push字符串随后的函数应为输出字符串）</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/22668034.jpg" alt=""></p>
<blockquote>
<p>回到关键跳转00DD5926处，判断密码为正确的条件为EDI = 0xDB，而EDI的值是EAX给的，而EAX为函数010Edito.00409C9B的返回值，这个函数可能为验证Key的关键函数，而我们动态调试发现有跳转直接跳转到cmp edi,0xdb。</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/93217778.jpg" alt=""></p>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/18045030.jpg" alt=""></p>
<blockquote>
<p>同样为函数010Edito.00409C9B，现在可以认为这是关键函数，此时EDI的值为0x177，为了验证此跳转为关键跳转，我们把EDI的值修改为0xDB。</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/13306046.jpg" alt=""></p>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/90664364.jpg" alt=""></p>
<blockquote>
<p>之后F9运行</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/56983231.jpg" alt=""></p>
<blockquote>
<p>验证成功！接下来我们进入函数分析。</p>
</blockquote>
<h3 id="第二步-分析关键函数"><a href="#第二步-分析关键函数" class="headerlink" title="第二步 分析关键函数"></a>第二步 分析关键函数</h3><blockquote>
<p>函数010Edito.00409C9B，参数情况为：</p>
<p>arg1 = 0x9 ；</p>
<p>arg2 = 0x4389；</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/43180291.jpg" alt=""></p>
<blockquote>
<p>从下往上看，找到需要的0xDB，而跳转条件是eax = 0x2D， 为函数010Edito.0040A826的返回值。</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/16623615.jpg" alt=""></p>
<blockquote>
<p>进入函数，该函数作用为将key取出，放在在局部变量数组中，数组起始地址为ebx-24</p>
</blockquote>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/20577830.jpg" alt=""></p>
<p><img src="http://yusakul-blog.oss-cn-shenzhen.aliyuncs.com/18-6-25/95763028.jpg" alt=""></p>
<blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; key[0 ]	= [ebx-24]=0x12</span><br><span class="line">&gt; key[1 ]	= [ebx-23]=0x34</span><br><span class="line">&gt; key[2 ]	= [ebx-22]=0x56</span><br><span class="line">&gt; key[3 ]	= [ebx-21]=0x78</span><br><span class="line">&gt; key[4 ]	= [ebx-20]=0x90</span><br><span class="line">&gt; key[5 ]	= [ebx-1F]=0x12</span><br><span class="line">&gt; key[6 ]	= [ebx-1E]=0x34</span><br><span class="line">&gt; key[7 ]	= [ebx-1D]=0x56</span><br><span class="line">&gt; key[8 ]	= [ebx-1C]=0x78</span><br><span class="line">&gt; key[9 ]	= [ebx-1B]=0x90</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
<p>密钥数组对应如上，该处汇编代码如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line">&gt; 013BDC2D   .  8BCF          MOV ECX,EDI</span><br><span class="line">&gt; 013BDC2F   .  50            PUSH EAX</span><br><span class="line">&gt; 013BDC30   .  E8 3ABF04FF   CALL 010Edito.00409B6F					;获取key存入局部变量数组[ebp-24]中</span><br><span class="line">&gt; 013BDC35   .  BE 1446E602   MOV ESI,010Edito.02E64614</span><br><span class="line">&gt; 013BDC3A   .  8D9B 00000000 LEA EBX,DWORD PTR DS:[EBX]</span><br><span class="line">&gt; 013BDC40   &gt;  FF36          PUSH DWORD PTR DS:[ESI]                  ;010Edito.02995120</span><br><span class="line">&gt; 013BDC42   .  8BCB          MOV ECX,EBX</span><br><span class="line">&gt; 013BDC44   .  FF15 E82CE702 CALL DWORD PTR DS:[&lt;&amp;Qt5Core.??8QString@@QBE_NPBD@Z&gt;]  ;  Qt5Core.??8QString@@QBE_NPBD@Z</span><br><span class="line">&gt; 013BDC4A   .  84C0          TEST AL,AL</span><br><span class="line">&gt; 013BDC4C   .  0F85 23020000 JNZ 010Edito.013BDE75</span><br><span class="line">&gt; 013BDC52   .  83C6 04       ADD ESI,0x4</span><br><span class="line">&gt; 013BDC55   .  81FE 1846E602 CMP ESI,010Edito.02E64618</span><br><span class="line">&gt; 013BDC5B   .^ 7C E3         JL SHORT 010Edito.013BDC40</span><br><span class="line">&gt; 013BDC5D   .  8A5D DF       MOV BL,BYTE PTR SS:[EBP-0x21]            ;  key[3]</span><br><span class="line">&gt; 013BDC60   .  8A7D E1       MOV BH,BYTE PTR SS:[EBP-0x1F]            ;  key[5]</span><br><span class="line">&gt; 013BDC63   .  80FB 9C       CMP BL,0x9C                              ;  是否等于0x9c</span><br><span class="line">&gt; 013BDC66   .  75 70         JNZ SHORT 010Edito.013BDCD8              ;  跳转到是否等于FC</span><br><span class="line">&gt; 013BDC68   .  8A45 DC       MOV AL,BYTE PTR SS:[EBP-0x24]            ;  key[0]</span><br><span class="line">&gt; 013BDC6B   .  3245 E2       XOR AL,BYTE PTR SS:[EBP-0x1E]            ;  key[0]^key[6]</span><br><span class="line">&gt; 013BDC6E   .  8845 E8       MOV BYTE PTR SS:[EBP-0x18],AL			;</span><br><span class="line">&gt; 013BDC71   .  8A45 DD       MOV AL,BYTE PTR SS:[EBP-0x23]			;  key[1]</span><br><span class="line">&gt; 013BDC74   .  3245 E3       XOR AL,BYTE PTR SS:[EBP-0x1D]			;  key[1]^key[7]</span><br><span class="line">&gt; 013BDC77   .  FF75 E8       PUSH DWORD PTR SS:[EBP-0x18]</span><br><span class="line">&gt; 013BDC7A   .  0FB6C8        MOVZX ECX,AL</span><br><span class="line">&gt; 013BDC7D   .  B8 00010000   MOV EAX,0x100</span><br><span class="line">&gt; 013BDC82   .  66:0FAFC8     IMUL CX,AX							  ;  (key[1]^key[7])*100</span><br><span class="line">&gt; 013BDC86   .  8A45 DE       MOV AL,BYTE PTR SS:[EBP-0x22]		    ;  key[2]</span><br><span class="line">&gt; 013BDC89   .  32C7          XOR AL,BH							  ;	 key[2]^key[5]</span><br><span class="line">&gt; 013BDC8B   .  0FB6C0        MOVZX EAX,AL</span><br><span class="line">&gt; 013BDC8E   .  66:03C8       ADD CX,AX							  ;   		   	 	 											;cx = (key[1]^key[7])*100 + key[2]^key[5]</span><br><span class="line">&gt; 013BDC91   .  0FB7F1        MOVZX ESI,CX</span><br><span class="line">&gt; 013BDC94   .  E8 AB9904FF   CALL 010Edito.00407644					</span><br><span class="line">&gt; 	013BD0B0  /&gt; \55            PUSH EBP</span><br><span class="line">&gt; 	013BD0B1  |.  8BEC          MOV EBP,ESP</span><br><span class="line">&gt; 	013BD0B3  |.  8B45 08       MOV EAX,[ARG.1]		;  eax = key[0]^key[6] </span><br><span class="line">&gt; 	013BD0B6  |.  34 18         XOR AL,0x18			;  al = key[0]^key[6]^0x18 </span><br><span class="line">&gt; 	013BD0B8  |.  04 3D         ADD AL,0x3D			;  al =	key[0]^key[6]^0x18 + 0x3D</span><br><span class="line">&gt; 	013BD0BA  |.  34 A7         XOR AL,0xA7			;  al =(key[0]^key[6]^0x18+0x3D)^0xA7</span><br><span class="line">&gt; 	013BD0BC  |.  5D            POP EBP                          </span><br><span class="line">&gt; 	013BD0BD  \.  C3            RETN</span><br><span class="line">&gt; 	</span><br><span class="line">&gt; 013BDC99   .  0FB6C0        MOVZX EAX,AL</span><br><span class="line">&gt; 013BDC9C   .  56            PUSH ESI          ;  esi = (key[1]^key[7])*100 + key[2]^key[5]</span><br><span class="line">&gt; 013BDC9D   .  8947 1C       MOV DWORD PTR DS:[EDI+0x1C],EAX</span><br><span class="line">&gt; 013BDCA0   .  E8 23A704FF   CALL 010Edito.004083C8</span><br><span class="line">&gt; 	013BD020  /&gt; \55            PUSH EBP</span><br><span class="line">&gt; 	013BD021  |.  8BEC          MOV EBP,ESP</span><br><span class="line">&gt; 	013BD023  |.  8B45 08       MOV EAX,[ARG.1]		;eax=(key[1]^key[7])*100+key[2]^key[5]</span><br><span class="line">&gt; 	013BD026  |.  B9 0B000000   MOV ECX,0xB			; ecx = 0xB</span><br><span class="line">&gt; 	013BD02B  |.  35 92780000   XOR EAX,0x7892		</span><br><span class="line">&gt; 					;eax=((key[1]^key[7])*100+key[2]^key[5])^0x7892</span><br><span class="line">&gt; 	013BD030  |.  05 304D0000   ADD EAX,0x4D30</span><br><span class="line">&gt; 					;eax=((key[1]^key[7])*100+key[2]^key[5])^0x7892 + 0x4D30</span><br><span class="line">&gt; 	013BD035  |.  35 21340000   XOR EAX,0x3421</span><br><span class="line">&gt; 					;eax=(((key[1]^key[7])*100+key[2]^key[5])^0x7892 + 0x4D30)^0x3421</span><br><span class="line">&gt; 	013BD03A  |.  0FB7C0        MOVZX EAX,AX</span><br><span class="line">&gt; 	013BD03D  |.  99            CDQ</span><br><span class="line">&gt; 	013BD03E  |.  F7F9          IDIV ECX		</span><br><span class="line">&gt; 					;eax=(((key[1]^key[7])*100+key[2]^key[5])^0x7892 + 0x4D30)^0x3421/0xB</span><br><span class="line">&gt; 	013BD040  |.  85D2          TEST EDX,EDX	;ecx/eax的余数否为0</span><br><span class="line">&gt; 	013BD042  |.  74 02         JE SHORT 010Edito.013BD046		;如果余数不为0,清零eax</span><br><span class="line">&gt; 	013BD044  |.  33C0          XOR EAX,EAX</span><br><span class="line">&gt; 	013BD046  |&gt;  5D            POP EBP                                </span><br><span class="line">&gt; 	013BD047  \.  C3            RETN</span><br><span class="line">&gt; </span><br><span class="line">&gt; 013BDCA5   .  8B4F 1C       MOV ECX,DWORD PTR DS:[EDI+0x1C]</span><br><span class="line">&gt; 										; ecx = (key[0]^key[6]^0x18+0x3D)^0xA7</span><br><span class="line">&gt; 013BDCA8   .  83C4 08       ADD ESP,0x8		</span><br><span class="line">&gt; 013BDCAB   .  0FB7C0        MOVZX EAX,AX</span><br><span class="line">&gt; 				;eax=(((key[1]^key[7])*100+key[2]^key[5])^0x7892 + 0x4D30)^0x3421</span><br><span class="line">&gt; 013BDCAE   .  8947 20       MOV DWORD PTR DS:[EDI+0x20],EAX</span><br><span class="line">&gt; 				;[EDI+0x20] =(((key[1]^key[7])*100+key[2]^key[5])^0x7892 + 0x4D30)^0x3421</span><br><span class="line">&gt; 013BDCB1   .  85C9          TEST ECX,ECX	</span><br><span class="line">&gt; 013BDCB3   .  0F84 BC010000 JE 010Edito.013BDE75	;ecx = 0 则eax=E7返回</span><br><span class="line">&gt; 013BDCB9   .  85C0          TEST EAX,EAX</span><br><span class="line">&gt; 013BDCBB   .  0F84 B4010000 JE 010Edito.013BDE75	;eax = 0 则eax=E7返回</span><br><span class="line">&gt; 013BDCC1   .  3D E8030000   CMP EAX,0x3E8</span><br><span class="line">&gt; 013BDCC6   .  0F87 A9010000 JA 010Edito.013BDE75	;eax &gt; 0x3E8 则eax=E7返回</span><br><span class="line">&gt; 013BDCCC   .  83F9 02       CMP ECX,0x2				;ecx小于等于1时，借位cf=1,否则cf=0</span><br><span class="line">&gt; 013BDCCF   .  1BF6          SBB ESI,ESI				; esi=esi-esi-CF=-cf</span><br><span class="line">&gt; 013BDCD1   .  23F1          AND ESI,ECX				;	esi = esi &amp; ecx	</span><br><span class="line">&gt; 013BDCD3   .  E9 B3000000   JMP 010Edito.013BDD8B</span><br><span class="line">&gt; 013BDCD8   &gt;  80FB FC       CMP BL,0xFC</span><br><span class="line">&gt; 013BDCDB   .  75 1F         JNZ SHORT 010Edito.013BDCFC                ;  不等于FC，跳转到是否等于AC</span><br><span class="line">&gt; 013BDCDD   .  C747 1C FF000&gt;MOV DWORD PTR DS:[EDI+0x1C],0xFF           ;  Case FC of switch 013BDC63</span><br><span class="line">&gt; 013BDCE4   .  BE FF000000   MOV ESI,0xFF</span><br><span class="line">&gt; 013BDCE9   .  C747 20 01000&gt;MOV DWORD PTR DS:[EDI+0x20],0x1</span><br><span class="line">&gt; 013BDCF0   .  C747 30 01000&gt;MOV DWORD PTR DS:[EDI+0x30],0x1</span><br><span class="line">&gt; 013BDCF7   .  E9 8F000000   JMP 010Edito.013BDD8B</span><br><span class="line">&gt; 013BDCFC   &gt;  80FB AC       CMP BL,0xAC</span><br><span class="line">&gt; 013BDCFF   .  0F85 70010000 JNZ 010Edito.013BDE75</span><br><span class="line">&gt; 013BDD05   .  8A45 DD       MOV AL,BYTE PTR SS:[EBP-0x23]              ;  Case AC of switch 013BDC63</span><br><span class="line">&gt; 013BDD08   .  3245 E3       XOR AL,BYTE PTR SS:[EBP-0x1D]</span><br><span class="line">&gt; 013BDD0B   .  0FB6C8        MOVZX ECX,AL</span><br><span class="line">&gt; 013BDD0E   .  B8 00010000   MOV EAX,0x100</span><br><span class="line">&gt; 013BDD13   .  66:0FAFC8     IMUL CX,AX</span><br><span class="line">&gt; 013BDD17   .  8A45 DE       MOV AL,BYTE PTR SS:[EBP-0x22]</span><br><span class="line">&gt; 013BDD1A   .  32C7          XOR AL,BH</span><br><span class="line">&gt; 013BDD1C   .  C747 1C 02000&gt;MOV DWORD PTR DS:[EDI+0x1C],0x2</span><br><span class="line">&gt; 013BDD23   .  0FB6C0        MOVZX EAX,AL</span><br><span class="line">&gt; 013BDD26   .  66:03C8       ADD CX,AX</span><br><span class="line">&gt; 013BDD29   .  0FB7C1        MOVZX EAX,CX</span><br><span class="line">&gt; 013BDD2C   .  50            PUSH EAX</span><br><span class="line">&gt; 013BDD2D   .  E8 96A604FF   CALL 010Edito.004083C8</span><br><span class="line">&gt; 013BDD32   .  0FB7C0        MOVZX EAX,AX</span><br><span class="line">&gt; 013BDD35   .  83C4 04       ADD ESP,0x4</span><br><span class="line">&gt; 013BDD38   .  8947 20       MOV DWORD PTR DS:[EDI+0x20],EAX</span><br><span class="line">&gt; 013BDD3B   .  85C0          TEST EAX,EAX</span><br><span class="line">&gt; 013BDD3D   .  0F84 32010000 JE 010Edito.013BDE75</span><br><span class="line">&gt; 013BDD43   .  3D E8030000   CMP EAX,0x3E8</span><br><span class="line">&gt; 013BDD48   .  0F87 27010000 JA 010Edito.013BDE75</span><br><span class="line">&gt; 013BDD4E   .  0FB655 E5     MOVZX EDX,BYTE PTR SS:[EBP-0x1B]</span><br><span class="line">&gt; 013BDD52   .  0FB64D E0     MOVZX ECX,BYTE PTR SS:[EBP-0x20]</span><br><span class="line">&gt; 013BDD56   .  0FB6C7        MOVZX EAX,BH</span><br><span class="line">&gt; 013BDD59   .  33D0          XOR EDX,EAX</span><br><span class="line">&gt; 013BDD5B   .  0FB645 E4     MOVZX EAX,BYTE PTR SS:[EBP-0x1C]</span><br><span class="line">&gt; 013BDD5F   .  33C8          XOR ECX,EAX</span><br><span class="line">&gt; 013BDD61   .  C1E2 08       SHL EDX,0x8</span><br><span class="line">&gt; 013BDD64   .  0FB645 E2     MOVZX EAX,BYTE PTR SS:[EBP-0x1E]</span><br><span class="line">&gt; 013BDD68   .  03D1          ADD EDX,ECX</span><br><span class="line">&gt; 013BDD6A   .  0FB64D DC     MOVZX ECX,BYTE PTR SS:[EBP-0x24]</span><br><span class="line">&gt; 013BDD6E   .  C1E2 08       SHL EDX,0x8</span><br><span class="line">&gt; 013BDD71   .  33C8          XOR ECX,EAX</span><br><span class="line">&gt; 013BDD73   .  03D1          ADD EDX,ECX</span><br><span class="line">&gt; 013BDD75   .  68 278C5B00   PUSH 010Edito.005B8C27                                 ;  </span><br><span class="line">&gt; 013BDD7A   .  52            PUSH EDX</span><br><span class="line">&gt; 013BDD7B   .  E8 0BCA04FF   CALL 010Edito.0040A78B</span><br><span class="line">&gt; 013BDD80   .  83C4 08       ADD ESP,0x8</span><br><span class="line">&gt; 013BDD83   .  8945 F0       MOV DWORD PTR SS:[EBP-0x10],EAX</span><br><span class="line">&gt; 013BDD86   .  8947 34       MOV DWORD PTR DS:[EDI+0x34],EAX</span><br><span class="line">&gt; 013BDD89   .  8BF0          MOV ESI,EAX</span><br><span class="line">&gt; 013BDD8B   &gt;  8D45 EC       LEA EAX,DWORD PTR SS:[EBP-0x14]</span><br><span class="line">&gt; 013BDD8E   .  50            PUSH EAX</span><br><span class="line">&gt; 013BDD8F   .  8D4F 04       LEA ECX,DWORD PTR DS:[EDI+0x4]</span><br><span class="line">&gt; 013BDD92   .  FF15 782BE702 CALL DWORD PTR DS:[&lt;&amp;Qt5Core.?toUtf8@QString@@QBE?AVQB&gt;;  Qt5Core.?toUtf8@QString@@QBE?AVQByteArray@@XZ</span><br><span class="line">&gt; 013BDD98   .  FF77 20       PUSH DWORD PTR DS:[EDI+0x20]</span><br><span class="line">&gt; 013BDD9B   .  33C0          XOR EAX,EAX</span><br><span class="line">&gt; 013BDD9D   .  C745 FC 00000&gt;MOV DWORD PTR SS:[EBP-0x4],0x0</span><br><span class="line">&gt; 013BDDA4   .  80FB FC       CMP BL,0xFC</span><br><span class="line">&gt; 013BDDA7   .  8D4D EC       LEA ECX,DWORD PTR SS:[EBP-0x14]</span><br><span class="line">&gt; 013BDDAA   .  56            PUSH ESI                                               ;  010Edito.02E64614</span><br><span class="line">&gt; 013BDDAB   .  0F95C0        SETNE AL</span><br><span class="line">&gt; 013BDDAE   .  50            PUSH EAX</span><br><span class="line">&gt; 013BDDAF   .  FF15 8C24E702 CALL DWORD PTR DS:[&lt;&amp;Qt5Core.?data@QByteArray@@QAEPADX&gt;;  Qt5Core.?data@QByteArray@@QAEPADXZ</span><br><span class="line">&gt; 013BDDB5   .  50            PUSH EAX</span><br><span class="line">&gt; 013BDDB6   .  E8 955004FF   CALL 010Edito.00402E50</span><br><span class="line">&gt; 013BDDBB   .  8BD0          MOV EDX,EAX</span><br><span class="line">&gt; 013BDDBD   .  83C4 10       ADD ESP,0x10</span><br><span class="line">&gt; 013BDDC0   .  3855 E0       CMP BYTE PTR SS:[EBP-0x20],DL</span><br><span class="line">&gt; 013BDDC3   .  0F85 81000000 JNZ 010Edito.013BDE4A</span><br><span class="line">&gt; 013BDDC9   .  8BCA          MOV ECX,EDX</span><br><span class="line">&gt; 013BDDCB   .  C1E9 08       SHR ECX,0x8</span><br><span class="line">&gt; 013BDDCE   .  3AF9          CMP BH,CL</span><br><span class="line">&gt; 013BDDD0   .  75 78         JNZ SHORT 010Edito.013BDE4A</span><br><span class="line">&gt; 013BDDD2   .  8BCA          MOV ECX,EDX</span><br><span class="line">&gt; 013BDDD4   .  C1E9 10       SHR ECX,0x10</span><br><span class="line">&gt; 013BDDD7   .  384D E2       CMP BYTE PTR SS:[EBP-0x1E],CL</span><br><span class="line">&gt; 013BDDDA   .  75 6E         JNZ SHORT 010Edito.013BDE4A</span><br><span class="line">&gt; 013BDDDC   .  C1E8 18       SHR EAX,0x18</span><br><span class="line">&gt; 013BDDDF   .  3845 E3       CMP BYTE PTR SS:[EBP-0x1D],AL</span><br><span class="line">&gt; 013BDDE2   .  75 66         JNZ SHORT 010Edito.013BDE4A</span><br><span class="line">&gt; 013BDDE4   .  80FB 9C       CMP BL,0x9C                                            ;  Switch (cases 9C..FC)</span><br><span class="line">&gt; 013BDDE7   .  75 0F         JNZ SHORT 010Edito.013BDDF8</span><br><span class="line">&gt; 013BDDE9   .  8B45 08       MOV EAX,DWORD PTR SS:[EBP+0x8]                         ;  Case 9C of switch 013BDDE4</span><br><span class="line">&gt; 013BDDEC   .  3B47 1C       CMP EAX,DWORD PTR DS:[EDI+0x1C]</span><br><span class="line">&gt; 013BDDEF   .  76 52         JBE SHORT 010Edito.013BDE43</span><br><span class="line">&gt; 013BDDF1   .  BE 4E000000   MOV ESI,0x4E</span><br><span class="line">&gt; 013BDDF6   .  EB 57         JMP SHORT 010Edito.013BDE4F</span><br><span class="line">&gt; 013BDDF8   &gt;  80FB FC       CMP BL,0xFC</span><br><span class="line">&gt; 013BDDFB   .  75 2E         JNZ SHORT 010Edito.013BDE2B</span><br><span class="line">&gt; 013BDDFD   .  0FB64D DE     MOVZX ECX,BYTE PTR SS:[EBP-0x22]                       ;  Case FC of switch 013BDDE4</span><br><span class="line">&gt; 013BDE01   .  0FB645 DD     MOVZX EAX,BYTE PTR SS:[EBP-0x23]</span><br><span class="line">&gt; 013BDE05   .  C1E1 08       SHL ECX,0x8</span><br><span class="line">&gt; 013BDE08   .  03C8          ADD ECX,EAX</span><br><span class="line">&gt; 013BDE0A   .  0FB645 DC     MOVZX EAX,BYTE PTR SS:[EBP-0x24]</span><br><span class="line">&gt; 013BDE0E   .  C1E1 08       SHL ECX,0x8</span><br><span class="line">&gt; 013BDE11   .  52            PUSH EDX</span><br><span class="line">&gt; 013BDE12   .  03C8          ADD ECX,EAX</span><br><span class="line">&gt; 013BDE14   .  51            PUSH ECX</span><br><span class="line">&gt; 013BDE15   .  E8 71C904FF   CALL 010Edito.0040A78B</span><br><span class="line">&gt; 013BDE1A   .  83C4 08       ADD ESP,0x8</span><br><span class="line">&gt; 013BDE1D   .  85C0          TEST EAX,EAX</span><br><span class="line">&gt; 013BDE1F   .  74 29         JE SHORT 010Edito.013BDE4A</span><br><span class="line">&gt; 013BDE21   .  8947 18       MOV DWORD PTR DS:[EDI+0x18],EAX</span><br><span class="line">&gt; 013BDE24   .  BE 93000000   MOV ESI,0x93</span><br><span class="line">&gt; 013BDE29   .  EB 24         JMP SHORT 010Edito.013BDE4F</span><br><span class="line">&gt; 013BDE2B   &gt;  80FB AC       CMP BL,0xAC</span><br><span class="line">&gt; 013BDE2E   .  75 1A         JNZ SHORT 010Edito.013BDE4A</span><br><span class="line">&gt; 013BDE30   .  8B45 F0       MOV EAX,DWORD PTR SS:[EBP-0x10]                        ;  Case AC of switch 013BDDE4</span><br><span class="line">&gt; 013BDE33   .  85C0          TEST EAX,EAX</span><br><span class="line">&gt; 013BDE35   .  74 13         JE SHORT 010Edito.013BDE4A</span><br><span class="line">&gt; 013BDE37   .  3945 0C       CMP DWORD PTR SS:[EBP+0xC],EAX</span><br><span class="line">&gt; 013BDE3A   .  76 07         JBE SHORT 010Edito.013BDE43</span><br><span class="line">&gt; 013BDE3C   .  BE 4E000000   MOV ESI,0x4E</span><br><span class="line">&gt; 013BDE41   .  EB 0C         JMP SHORT 010Edito.013BDE4F</span><br><span class="line">&gt; 013BDE43   &gt;  BE 2D000000   MOV ESI,0x2D</span><br><span class="line">&gt; 013BDE48   .  EB 05         JMP SHORT 010Edito.013BDE4F</span><br><span class="line">&gt; 013BDE4A   &gt;  BE E7000000   MOV ESI,0xE7                                           ;  Default case of switch 013BDDE4</span><br><span class="line">&gt; 013BDE4F   &gt;  8D4D EC       LEA ECX,DWORD PTR SS:[EBP-0x14]</span><br><span class="line">&gt; 013BDE52   .  C745 FC FFFFF&gt;MOV DWORD PTR SS:[EBP-0x4],-0x1</span><br><span class="line">&gt; 013BDE59   .  FF15 7C24E702 CALL DWORD PTR DS:[&lt;&amp;Qt5Core.??1QByteArray@@QAE@XZ&gt;]   ;  Qt5Core.??1QByteArray@@QAE@XZ</span><br><span class="line">&gt; 013BDE5F   .  8BC6          MOV EAX,ESI                                            ;  010Edito.02E64614</span><br><span class="line">&gt; 013BDE61   .  8B4D F4       MOV ECX,DWORD PTR SS:[EBP-0xC]</span><br><span class="line">&gt; 013BDE64   .  64:890D 00000&gt;MOV DWORD PTR FS:[0],ECX</span><br><span class="line">&gt; 013BDE6B   .  59            POP ECX</span><br><span class="line">&gt; 013BDE6C   .  5F            POP EDI</span><br><span class="line">&gt; 013BDE6D   .  5E            POP ESI                                                ;  010Edito.02E64614</span><br><span class="line">&gt; 013BDE6E   .  5B            POP EBX</span><br><span class="line">&gt; 013BDE6F   .  8BE5          MOV ESP,EBP</span><br><span class="line">&gt; 013BDE71   .  5D            POP EBP</span><br><span class="line">&gt; 013BDE72   .  C2 0800       RETN 0x8</span><br><span class="line">&gt; 013BDE75   &gt;  B8 E7000000   MOV EAX,0xE7                                           ;  Default case of switch 013BDC63</span><br><span class="line">&gt; 013BDE7A   .  8B4D F4       MOV ECX,DWORD PTR SS:[EBP-0xC]</span><br><span class="line">&gt; 013BDE7D   .  64:890D 00000&gt;MOV DWORD PTR FS:[0],ECX</span><br><span class="line">&gt; 013BDE84   .  59            POP ECX</span><br><span class="line">&gt; 013BDE85   .  5F            POP EDI</span><br><span class="line">&gt; 013BDE86   .  5E            POP ESI                                                ;  010Edito.02E64614</span><br><span class="line">&gt; 013BDE87   .  5B            POP EBX</span><br><span class="line">&gt; 013BDE88   .  8BE5          MOV ESP,EBP</span><br><span class="line">&gt; 013BDE8A   .  5D            POP EBP</span><br><span class="line">&gt; 013BDE8B   .  C2 0800       RETN 0x8</span><br><span class="line">&gt; 013BDE8E   &gt;  B8 93000000   MOV EAX,0x93</span><br><span class="line">&gt; 013BDE93   .  8B4D F4       MOV ECX,DWORD PTR SS:[EBP-0xC]</span><br><span class="line">&gt; 013BDE96   .  64:890D 00000&gt;MOV DWORD PTR FS:[0],ECX</span><br><span class="line">&gt; 013BDE9D   .  59            POP ECX</span><br><span class="line">&gt; 013BDE9E   .  5F            POP EDI</span><br><span class="line">&gt; 013BDE9F   .  5E            POP ESI                                                ;  010Edito.02E64614</span><br><span class="line">&gt; 013BDEA0   .  5B            POP EBX</span><br><span class="line">&gt; 013BDEA1   .  8BE5          MOV ESP,EBP</span><br><span class="line">&gt; 013BDEA3   .  5D            POP EBP</span><br><span class="line">&gt; 013BDEA4   .  C2 0800       RETN 0x8</span><br><span class="line">&gt; </span><br><span class="line">&gt; </span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<blockquote>
</blockquote>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">梁言</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/06/25/010 Editor分析/">http://yoursite.com/2018/06/25/010 Editor分析/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/逆向工程/">逆向工程</a></div><nav id="pagination"><div class="next-post pull-right"><a href="/2018/06/21/Android游戏分析/"><span>Android游戏分析</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2018 By 梁言</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.5"></script><script src="/js/fancybox.js?version=1.5.5"></script><script src="/js/sidebar.js?version=1.5.5"></script><script src="/js/copy.js?version=1.5.5"></script><script src="/js/fireworks.js?version=1.5.5"></script><script src="/js/transition.js?version=1.5.5"></script><script src="/js/scroll.js?version=1.5.5"></script><script src="/js/head.js?version=1.5.5"></script></body></html>